---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->



```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# electionViz

<!-- badges: start -->
[![Travis build status](https://travis-ci.org/heike/electionViz.svg?branch=master)](https://travis-ci.org/heike/electionViz)
<!-- badges: end -->

R package for visualizations of election (or poll) results as easy as adding `geom_electoral_building`.

## Installation

The development version from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("heike/electionViz")
```
## Example

We will be inundated with information about the state of the polls in the build-up to the upcoming Presidential election of 2020.

With the tools of this package you will be able to pick your favorite visualization(s) and explore the results your own way.

```{r, message = FALSE, warning = FALSE}
# load the package
library(electionViz)
library(tidyverse)
```


### Hexbin Cartogram of Election Results by State

Each state is represented by one hexagon. This map has been made available by Andrew X Hill at [CARTO](https://team.carto.com/u/andrew/tables/andrew.us_states_hexgrid/public/map).


```{r example, fig.height=3.5}
data(elections)
el12 <- elections %>% filter(year == 2012)
gg12 <- hexplot(el12$state, el12$perc_rep > el12$perc_dem) +
  scale_fill_party("", labels=c("Democrat", "Republican")) +
  theme(legend.position = "bottom") +
  ggtitle("Election 2012")

el16 <- elections %>% filter(year == 2016)
gg16 <- hexplot(el16$state, el16$perc_rep > el16$perc_dem) +
  scale_fill_party("", labels=c("Democrat", "Republican")) +
  theme(legend.position = "bottom") +
  ggtitle("Election 2016")

gridExtra::grid.arrange(gg12, gg16, ncol=2)
```


### Hexbin Cartogram of the US Presidential Election by Electoral Votes

Each state is represented by a set of hexagons corresponding in number to the state's electoral votes. This map was adapted from the object `sf_FiveThirtyEightElectoralCollege` in Bhaskar Karambelkar's R package [tilegramsR](https://github.com/bhaskarvk/tilegramsR).

```{r electoral, echo=FALSE, warning = FALSE, message = FALSE}
# Merge geospatial and numerical information
electoral_hexplus <- electoral_hex %>%
  left_join(elections, by=c("state" = "state_po"))

# Make a first chloropleth map
electoral_hexplus %>%
  filter(year >= 2012) %>%
  mutate(
    Election = year,
    Outcome = c("Republican", "Democrat")[as.numeric(perc_rep < perc_dem) + 1]) %>%
  ggplot(aes(x = long, y = lat, group = group)) +
  geom_polygon(aes(fill =  Outcome), 
               colour = "grey60", size = 0.1, alpha = 0.9) +
  geom_text(aes(x = centerX, y = centerY, label = state), 
            colour = "grey90", size = 3, 
            data = unique(electoral_state_outline_hex[,c("centerX", "centerY", "state", "group")])) +
  geom_path(colour = "grey70", size = 0.35, 
            data = electoral_state_outline_hex) +
  theme_void() +
#  coord_map() +
  facet_wrap(~Election, labeller = "label_both") +
  theme(legend.position = "bottom") +
  ggtitle("US Presidential Election results by electoral votes") +
  scale_fill_party()
```


### Electoral Building of the U.S. Presidential Election by Electoral Votes and Margin of Victory  

"Electoral Building" diagram, inspired by a 2000 graphic from the New York Times. Vote margin is represented on the x axis, while number of electoral votes is represented in the height. 

```{r building, echo = F, warning = F, message = F, fig.width = 6, fig.height = 9, out.width='70%'}

# make an electoral building plot! 
electoral_building(state_district = electoral_votes_2016$state_district, 
                        electoral_votes = electoral_votes_2016$electoral_votes, 
                        perc_dem = electoral_votes_2016$perc_dem, 
                        perc_rep = electoral_votes_2016$perc_rep) +
  scale_color_party("Party") +
  scale_fill_party("Party") +
  theme(legend.position = "bottom")
```

